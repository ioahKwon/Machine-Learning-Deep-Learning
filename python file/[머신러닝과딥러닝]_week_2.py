# -*- coding: utf-8 -*-
"""[머신러닝과딥러닝] Week_2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1pgBZt8NPWNgiIAoiNnZ9qYhkTVnQys1d

# **[머신러닝과딥러닝] 수업 정리 Week #2**

### _2020.08._ SKKU Lecture Summary by IOAH


---

### 1. 간단한 1차 선형회귀모형
"""

from sklearn.linear_model import LinearRegression
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt

reg = LinearRegression()

#다른 샘플을 만들어 다양한 선형회귀식을 도출해볼 수 있다.
Xsample=[[1],[2],[3],[4],[5]]
Ysample=[[3],[5],[7],[9],[11]]

plt.title('data points')
plt.xlabel('x')
plt.ylabel('y')
plt.scatter(Xsample,Ysample)

Model=reg.fit(Xsample,Ysample)
print("coef")
print(Model.coef_)
print("intercept")
print(Model.intercept_)

"""> 간단한 1차 선형회귀모형을 만기 위해 입력(x)과 출력(y)의 관계가 'y=2x+1'이 되도록 데이터를 구성하고 선형회귀를 진행한 결과, 예상대로 좋은 예측을 한 것을 볼 수 있다."""

Model.predict([[15]])

plt.title('Linear Regression sample')
plt.xlabel('x')
plt.ylabel('y')
plt.scatter(Xsample,Ysample)
plt.plot(Xsample,Model.coef_*Xsample + Model.intercept_)

reg = LinearRegression()

#다른 샘플을 만들어 다양한 선형회귀식을 도출해볼 수 있다.
Xsample=[[21],[12],[3],[43],[25]]
Ysample=[[31],[23],[12],[39],[11]]

plt.title('data points')
plt.xlabel('x')
plt.ylabel('y')
plt.scatter(Xsample,Ysample)

Model=reg.fit(Xsample,Ysample)
print("coef")
print(Model.coef_)
print("intercept")
print(Model.intercept_)

Model.predict([[15]])

plt.title('Linear Regression sample')
plt.xlabel('x')
plt.ylabel('y')
plt.scatter(Xsample,Ysample)
plt.plot(Xsample,Model.coef_*Xsample + Model.intercept_)

"""여기서 ‘y=2x+1’ 말고도 다른 식이 나오도록 x, y값을 임의로 바꿔서 다시 시행해본 결과 예상대로 좋은 예측을 한 것을 볼 수 있으며 입출력 관계도 전 실험과는 다르게 나온 것을 확인할 수 있었다.

### 2. California Housing 데이터셋에 대한 선형회귀모형
"""

from sklearn.linear_model import LinearRegression
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt

from sklearn.datasets import fetch_california_housing

california = fetch_california_housing()
X=california.data
DF=pd.DataFrame(X,columns=california.feature_names)
Y=california.target
print(DF)

i=3
plt.title(california.feature_names[i]+' & ' + 'target')
plt.xlabel(california.feature_names[i])
plt.ylabel('target')
plt.scatter(DF[california.feature_names[i]],Y)
plt.legend()
plt.show()

reg = LinearRegression()
Model=reg.fit(X,Y)
print("coef")
print(Model.coef_)
print("intercept")
print(Model.intercept_)

i=0
plt.title(california.feature_names[i]+' & ' + 'target')
plt.xlabel(california.feature_names[i])
plt.ylabel('target')
plt.scatter(DF[california.feature_names[i]],Y)
plt.plot(DF[california.feature_names[i]],Model.coef_[i]*DF[california.feature_names[i]],'r-')
plt.legend()
plt.show()

DF.mean()

Model.predict([DF.mean()])

"""다양한 feature를 가진 데이터로 선형회귀방정식을 도출하기 위해 캘리포니아 하우징 데이터셋을 사용하여 선형회귀분석을 해보았습니다. 

이 데이터는 특징 데이터에 MedInc, HouseAge, AveRoom 등 다양한 feature로 구성되어 있습니다. 

타겟 데이터를 캘리포니아 내 주택 가격으로 놔두고 각 feature와 타겟 값 사이의 관계를 시각화해서 학습시키고 결과를 확인해본 결과 좋은 선형회귀모형을 보였음을 확인할 수 있습니다.

 각 변수의 평균 값을 구하고 그 평균값을 토대로 예측한 집값 또한 잘 구해졌음을 알 수 있습니다.
"""